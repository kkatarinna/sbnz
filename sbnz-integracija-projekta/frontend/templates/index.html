<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Drools Frontend</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

</head>
<body>
    {% import "macros.html" as macros %}
    <h1>Drools Frontend</h1>
    <form action="{{ url_for('run_drools') }}" method="post">
        <button type="submit">Skeniraj uređaje</button>
    </form>
    <form action="{{ url_for('run_drools_network') }}" method="post">
        <button type="submit">Skeniraj mrežne servise</button>
    </form>

    {% if result %}
    <div class="result-box">
        <div class="message">{{ result.message }}</div>
        <!-- Broj aktiviranih pravila -->
        {% if result.countTemp %}
            <p><strong>Activated rules:</strong> {{ result.countTemp }}</p>
        {% endif %}

        <!-- Lista fired pravila -->
        {% if result.firedTempRules %}
            <p><strong>Rules:</strong></p>
            <ul>
                {% for rule in result.firedTempRules %}
                    <li>{{ rule }}</li>
                {% endfor %}
            </ul>
        {% endif %}
        
        <!-- Tabela uređaja -->
        {% if result.devices %}
            {{ macros.render_table(
                ['IP adresa', 'OS Name', 'OS Type', 'OS Version'],
                devices
            ) }}
        {% endif %}
        {% endif %}
    


    {% if tempsession_table %}
        <h3>Rezultat skeniranja mrežnih servisa</h3>
        {{ macros.render_table(
            ['ID', 'Device IP', 'Naziv / CVE kod', 'Verzija / Severity', 'Port', 'Opis / Rationale'],
            tempsession_table
        ) }}
    {% endif %}
    </div>

</body>
</html>
